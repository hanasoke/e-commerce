<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <% if flash[:success] %>
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <strong><%= flash[:success] %></strong>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                <% flash[:success] = nil %>
            <% end %>
        </div>
    </div>    
    <h3>Detail Transaction</h3>
    <hr>

    <% if @transactions.empty? %>
        <p class="text-muted">Belum ada transaksi</p>
    <% else %>
        <% @transactions.each do |trx| %>
            <div class="card mb-3">
                <div class="row g-0">
                    <div class="col-md-2">
                        <% if trx['item_photo'] %>
                            <img src="/uploads/items/<%= trx['item_photo'] %>" class="img-fluid rounded-start" alt="<%= trx['item_name'] %>">
                        <% else %>
                            <img src="/img/question.png" class="img-fluid rounded-start" alt="No Image">
                        <% end %>
                    </div>
                    <div class="col-md-10">
                        <div class="card-body">
                            <h5>
                                <%= trx['item_name'] %>
                            </h5>

                            <form action="/payment/<%= trx['transaction_id'] %>" method="POST" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <label for="jumlah" class="form-label">Jumlah</label>
                                    <input type="number" class="form-control" id="jumlah" value="<%= trx['quantity'] %>">
                                </div>
                                <div class="mb-3">
                                    <label for="jumlah" class="form-label">Catatan : </label>
                                    <textarea type="email" class="form-control" id="jumlah" value="<%= trx['note'] %>"><%= trx['note'] %></textarea>
                                </div>
                                <p>Total: <b><%= rupiah_currency(trx['total_price']) %></b></p>
                                <p>Status Pembayaran: 
                                    <span class="badge bg-info"><%= trx['payment_status'] %></span>
                                </p>
                                <div class="mb-3">
                                    <label for="pan" class="form-label">Payment Account Number</label>
                                    <input type="text" class="form-control" id="pan" placeholder="input your account number">
                                </div>
                                <div class="mb-3">
                                    <label for="payment_method" class="form-label">Payment Method</label>
                                    <select class="form-select" id="payment_method" name="payment_method">
                                        <option value="Select Your Payment Method">Select Your Payment Method</option>
                                        <option value="E-Wallet">E-Wallet</option>
                                        <option value="Bank">Bank</option>
                                        <option value="Virtual Account">Virtual Account</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="payment_photo" class="form-label">Payment Photo</label>
                                    <input class="form-control" type="file" id="payment_photo" name="payment_photo" >
                                </div>
                                
                                <div class="mb-3">
                                    <% if trx['payment_photo'] %>
                                        <p>Payment Proof:</p>
                                        <img class="img-fluid rounded" src="/uploads/payments/<%= trx['payment_photo'] %>" style="max-width: 200px;" >
                                    <% end %>
                                </div>

                                <div class="row">
                                    <div class="col">
                                        <p class="float-end">Tanggal Transaksi : <%= trx['transaction_date'] %></label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <button type="submit" class="btn btn-primary float-end">Checkout</button>  
                                    </div>
                                </div>
                            </form>
                                                      
                        </div>
                    </div>
                </div>
            </div>
        <% end %>
    <% end %>
</div>