<% 
    english_months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']

    birthdate = Date.parse(@profile['birthdate']) rescue nil 

    formatted_birthdate = birthdate ? "#{birthdate.day} #{english_months[birthdate.month - 1]} #{birthdate.year}" : ''

    # calculated the age 
    today = Date.today 
    age = if birthdate
        age = today.year - birthdate.year 
        age -= 1 if (today.month < birthdate.month) || (today.month == birthdate.month && today.day < birthdate.day)
        age
    else 
        nil
    end  
%>


<div class="col-lg-8">
    <div class="card shadow-lg border-0 rounded-lg mt-5 mb-5">
        <div class="card-header">
            <h3 class="text-center font-weight-light my-4">Create An Account</h3>
        </div>

        <div class="card-body">
            <div class="row">
                <div class="col">
                    <% if @errors&.any? %>
                        <% @errors.each do |e| %>
                            <div class="alert alert-warning alert-dismissible fade show" role="alert">
                                <div><%= e %></div>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        <% end %>
                    <% end %>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <% if session[:success] %>
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <div>
                                <%= session.delete(:success)%>
                            </div>
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    <% end %>
                </div>
            </div>
                <div class="col-md-12 mb-3">
                    <label for="name" class="form-label">Seller Name</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fa-solid fa-user"></i>
                        </span>
                        <input type="text" class="form-control" id="name" name="name" value="<%= @profile['name'] %>" disabled />
                    </div>
                </div>

                <div class="col-md-12 mb-3">
                    <label for="email" class="form-label">Seller Email</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fa-solid fa-envelope"></i>
                        </span>
                        <input type="email" class="form-control" id="email" name="email" value="<%= @profile['email'] %>" disabled />
                    </div>
                </div>

                <div class="col-md-12 mb-3">
                    <label for="phone" class="form-label">Seller Phone Number</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fa-solid fa-phone"></i>
                        </span>
                        <input type="phone" class="form-control" id="phone" name="phone" value="<%= @profile['phone'] %>" disabled />
                    </div>
                </div>

                <div class="col-md-12 mb-3">
                    <label for="birthdate" class="form-label">Birthdate</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fa-solid fa-calendar"></i>
                        </span>
                        <input type="birthdate" class="form-control" id="birthdate" name="birthdate" value="<%= formatted_birthdate %>" disabled/>
                    </div>
                </div>

                <div class="col-md-12 mb-3">
                    <label for="birthdate" class="form-label">Age</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fa-solid fa-calendar"></i>
                        </span>
                        <input type="text" class="form-control" id="age" value="<%= age ? "#{age} years" : '' %>" disabled/>
                    </div>
                </div>
            <form action="/seller_register/<%= current_user['user_id'] %>" method="post" enctype="multipart/form-data">
                <div class="col-md-12 mb-3">
                    <label for="identity_card" class="form-label">Identity Card</label>
                    <input class="form-control" type="file" id="identity_card" name="identity_photo">
                </div>

                <div class="mt-4 mb-0">
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="card-footer text-center py-3">
            <div class="small">Have an account?<a href="/login">Go to login</a></div>
        </div>
    </div>
</div>